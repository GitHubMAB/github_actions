{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/sarif-2.1/schema/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.494", "informationUri": "https://checkov.io", "rules": [{"id": "CKV_AZURE_227", "name": "Ensure that the AKS cluster encrypt temp disks, caches, and data flows between Compute and Storage resources", "shortDescription": {"text": "Ensure that the AKS cluster encrypt temp disks, caches, and data flows between Compute and Storage resources"}, "fullDescription": {"text": "Ensure that the AKS cluster encrypt temp disks, caches, and data flows between Compute and Storage resources"}, "help": {"text": "Ensure that the AKS cluster encrypt temp disks, caches, and data flows between Compute and Storage resources\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azure-227"}, {"id": "CKV_AZURE_7", "name": "Ensure AKS cluster has Network Policy configured", "shortDescription": {"text": "Ensure AKS cluster has Network Policy configured"}, "fullDescription": {"text": "Ensure AKS cluster has Network Policy configured"}, "help": {"text": "Ensure AKS cluster has Network Policy configured\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-4"}, {"id": "CKV_AZURE_141", "name": "Ensure AKS local admin account is disabled", "shortDescription": {"text": "Ensure AKS local admin account is disabled"}, "fullDescription": {"text": "Ensure AKS local admin account is disabled"}, "help": {"text": "Ensure AKS local admin account is disabled\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/ensure-azure-kubernetes-service-aks-local-admin-account-is-disabled"}, {"id": "CKV_AZURE_226", "name": "Ensure ephemeral disks are used for OS disks", "shortDescription": {"text": "Ensure ephemeral disks are used for OS disks"}, "fullDescription": {"text": "Ensure ephemeral disks are used for OS disks"}, "help": {"text": "Ensure ephemeral disks are used for OS disks\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azure-226"}, {"id": "CKV_AZURE_115", "name": "Ensure that AKS enables private clusters", "shortDescription": {"text": "Ensure that AKS enables private clusters"}, "fullDescription": {"text": "Ensure that AKS enables private clusters"}, "help": {"text": "Ensure that AKS enables private clusters\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-enables-private-clusters"}, {"id": "CKV_AZURE_232", "name": "Ensure that only critical system pods run on system nodes", "shortDescription": {"text": "Ensure that only critical system pods run on system nodes"}, "fullDescription": {"text": "Ensure that only critical system pods run on system nodes"}, "help": {"text": "Ensure that only critical system pods run on system nodes\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azure-232"}, {"id": "CKV_AZURE_4", "name": "Ensure AKS logging to Azure Monitoring is Configured", "shortDescription": {"text": "Ensure AKS logging to Azure Monitoring is Configured"}, "fullDescription": {"text": "Ensure AKS logging to Azure Monitoring is Configured"}, "help": {"text": "Ensure AKS logging to Azure Monitoring is Configured\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-1"}, {"id": "CKV_AZURE_171", "name": "Ensure AKS cluster upgrade channel is chosen", "shortDescription": {"text": "Ensure AKS cluster upgrade channel is chosen"}, "fullDescription": {"text": "Ensure AKS cluster upgrade channel is chosen"}, "help": {"text": "Ensure AKS cluster upgrade channel is chosen\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-171"}, {"id": "CKV_AZURE_6", "name": "Ensure AKS has an API Server Authorized IP Ranges enabled", "shortDescription": {"text": "Ensure AKS has an API Server Authorized IP Ranges enabled"}, "fullDescription": {"text": "Ensure AKS has an API Server Authorized IP Ranges enabled"}, "help": {"text": "Ensure AKS has an API Server Authorized IP Ranges enabled\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-3"}, {"id": "CKV_AZURE_168", "name": "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods.", "shortDescription": {"text": "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods."}, "fullDescription": {"text": "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods."}, "help": {"text": "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods.\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/azr-kubernetes-168"}, {"id": "CKV_AZURE_170", "name": "Ensure that AKS use the Paid Sku for its SLA", "shortDescription": {"text": "Ensure that AKS use the Paid Sku for its SLA"}, "fullDescription": {"text": "Ensure that AKS use the Paid Sku for its SLA"}, "help": {"text": "Ensure that AKS use the Paid Sku for its SLA\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-170"}, {"id": "CKV_AZURE_117", "name": "Ensure that AKS uses disk encryption set", "shortDescription": {"text": "Ensure that AKS uses disk encryption set"}, "fullDescription": {"text": "Ensure that AKS uses disk encryption set"}, "help": {"text": "Ensure that AKS uses disk encryption set\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-uses-disk-encryption-set"}, {"id": "CKV_AZURE_172", "name": "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters", "shortDescription": {"text": "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters"}, "fullDescription": {"text": "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters"}, "help": {"text": "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-172"}, {"id": "CKV_AZURE_116", "name": "Ensure that AKS uses Azure Policies Add-on", "shortDescription": {"text": "Ensure that AKS uses Azure Policies Add-on"}, "fullDescription": {"text": "Ensure that AKS uses Azure Policies Add-on"}, "help": {"text": "Ensure that AKS uses Azure Policies Add-on\nResource: azurerm_kubernetes_cluster.aks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-uses-azure-policies-add-on"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV_AZURE_227", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure that the AKS cluster encrypt temp disks, caches, and data flows between Compute and Storage resources"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_7", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure AKS cluster has Network Policy configured"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_141", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure AKS local admin account is disabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_226", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure ephemeral disks are used for OS disks"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_115", "ruleIndex": 4, "level": "error", "attachments": [], "message": {"text": "Ensure that AKS enables private clusters"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_232", "ruleIndex": 5, "level": "error", "attachments": [], "message": {"text": "Ensure that only critical system pods run on system nodes"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_4", "ruleIndex": 6, "level": "error", "attachments": [], "message": {"text": "Ensure AKS logging to Azure Monitoring is Configured"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_171", "ruleIndex": 7, "level": "error", "attachments": [], "message": {"text": "Ensure AKS cluster upgrade channel is chosen"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_6", "ruleIndex": 8, "level": "error", "attachments": [], "message": {"text": "Ensure AKS has an API Server Authorized IP Ranges enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_168", "ruleIndex": 9, "level": "error", "attachments": [], "message": {"text": "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods."}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_170", "ruleIndex": 10, "level": "error", "attachments": [], "message": {"text": "Ensure that AKS use the Paid Sku for its SLA"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_117", "ruleIndex": 11, "level": "error", "attachments": [], "message": {"text": "Ensure that AKS uses disk encryption set"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_172", "ruleIndex": 12, "level": "error", "attachments": [], "message": {"text": "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_116", "ruleIndex": 13, "level": "error", "attachments": [], "message": {"text": "Ensure that AKS uses Azure Policies Add-on"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "aks.tf"}, "region": {"startLine": 14, "endLine": 35, "snippet": {"text": "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n  name                = \"aks-demo\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  dns_prefix          = \"aks-demo\"\n\n  kubernetes_version  = \"1.34.0\"\n\n  default_node_pool {\n    name       = \"system\"\n    node_count = 2\n    vm_size    = \"Standard_B2s_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  network_profile {\n    network_plugin = \"azure\"\n  }\n}\n"}}}}]}]}]}